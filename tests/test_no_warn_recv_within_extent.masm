extern function malloc(size: int32) -> cstring = "malloc";
extern function free(ptr: cstring) = "free";
extern function recv(sock: int64, buf: cstring, len: int32, flags: int32) -> int32 = "recv";

function main() -> int32 {
  var sock: int64 = 0;
  var buf: cstring = malloc(4096);
  if (buf == 0) {
    return 1;
  }

  var n: int32 = recv(sock, buf, 1024, 0);
  free(buf);
  return n;
}

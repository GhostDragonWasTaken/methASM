; Generated by MethASM
; x86-64 Assembly Output

section .text
; Code section

; First pass: processing 3 declarations
; Declaration 0 type: 3 (AST_INLINE_ASM = 10)
; Declaration 1 type: 2 (AST_INLINE_ASM = 10)
; Declaration 2 type: 2 (AST_INLINE_ASM = 10)
    ; Struct declaration: Point
    ; Struct Point: size=16, alignment=8

global fast_add

fast_add:
    push rbp        ; Save old base pointer
    mov rbp, rsp  ; Set new base pointer
    ; Save callee-saved registers
    push rbx         ; Save callee-saved register
    push r12         ; Save callee-saved register
    push r13         ; Save callee-saved register
    push r14         ; Save callee-saved register
    push r15         ; Save callee-saved register
    ; Registering 2 function parameters
    ; Parameter 'a' in register rcx
    ; Parameter 'b' in register rdx
    ; Begin inline assembly block
    ; Preserve registers for inline assembly
    push rax           ; Preserve RAX
    push rcx           ; Preserve RCX
    push rdx           ; Preserve RDX
    push r8            ; Preserve R8
    push r9            ; Preserve R9
    push r10           ; Preserve R10
    push r11           ; Preserve R11
    mov eax , a add eax , b mov sum , eax
    ; Restore registers after inline assembly
    pop r11            ; Restore R11
    pop r10            ; Restore R10
    pop r9             ; Restore R9
    pop r8             ; Restore R8
    pop rdx            ; Restore RDX
    pop rcx            ; Restore RCX
    pop rax            ; Restore RAX
    ; End inline assembly block
    ; Return statement
    ; Load variable: sum
    ; Warning: Variable sum not found in symbol table
    mov rax, 0        ; Default to 0
    ; Return value in %rax
    jmp Lfast_add_exit
Lfast_add_exit:
    ; Function epilogue
    mov rsp, rbp  ; Restore stack pointer
    ; Restore callee-saved registers
    pop r15          ; Restore callee-saved register
    pop r14          ; Restore callee-saved register
    pop r13          ; Restore callee-saved register
    pop r12          ; Restore callee-saved register
    pop rbx          ; Restore callee-saved register
    pop rbp         ; Restore old base pointer
    ret               ; Return to caller

global main

main:
    push rbp        ; Save old base pointer
    mov rbp, rsp  ; Set new base pointer
    ; Save callee-saved registers
    push rbx         ; Save callee-saved register
    push r12         ; Save callee-saved register
    push r13         ; Save callee-saved register
    push r14         ; Save callee-saved register
    push r15         ; Save callee-saved register
    ; Registering 0 function parameters
    ; Unhandled statement type: 14
    ; Unhandled statement type: 14
    ; Unhandled statement type: 14
    ; Unhandled statement type: 14
    ; Return statement
    ; Integer literal: 0
    mov rax, 0
    ; Return value in %rax
    jmp Lmain_exit
Lmain_exit:
    mov rax, 0
    leave
    ret

; Default program entry point
global _start
_start:
    ; Exit gracefully
    mov rax, 60    ; sys_exit
    mov rdi, 0     ; exit status
    syscall
